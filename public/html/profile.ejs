<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Profile</title>
      <link rel="stylesheet" href="/css/profile.css">
      <link rel="stylesheet" href="/css/styles.css">
  </head>
  <body>
      <div class="top-container">
        <i class="fa-solid fa-right-from-bracket" id="logout-icon" onclick="window.location.href='/auth/logout'"><span>Logout</span></i>
        <h1><%= user.name %>'s Profile</h1>
      </div>

      <div id="container">
          <!-- Sold Products Section -->
          <div id="sold">
            <h2>Sold Products</h2>
            <% if (soldProduct.length > 0) { %>
              <ul>
                <% soldProduct.forEach(function(item) { %>
                  <li>
                    <strong><%= item.title %></strong> - Sold for ₹<%= item.maxamount %>
                  </li>
                <% }); %>
              </ul>
            <% } else { %>
              <p>No products sold yet.</p>
            <% } %>            
          </div>

          <!-- Active Auctions Section -->
          <div class="Bids">
            <h2>Active Auctions</h2>

<% if (auction && auction.length > 0) { %>
    <div class="auction-list">
        <% auction.forEach(auction => { %>
            <div class="auction-card">
                <h3><%= auction.title %></h3>
                <p><strong>Description:</strong> <%= auction.description %></p>
                <p><strong>Current Max Bid:</strong> ₹<%= auction.maxamount %></p>
                <p><strong>End Time:</strong> <%= new Date(auction.end_time).toLocaleString() %></p>

                <div class="auction-actions">
                    <!-- Edit Button -->
                    <form action="auctions/edit/<%= auction._id %>" method="GET" style="display:inline;">
                        <button type="submit">Edit</button>
                    </form>

                    <!-- Delete Button -->
                    <form action="auctions/delete/<%= auction._id %>" method="POST" onsubmit="return confirm('Are you sure you want to delete this auction?');" style="display:inline;">
                        <button type="submit" style="background-color: red; color: white;">Delete</button>
                    </form>
                </div>
            </div>
            <hr>
        <% }); %>
    </div>
<% } else { %>
    <p>No active auctions found.</p>
<% } %>
  
          </div>          

          <!-- Won Auctions Awaiting Payment -->
          <div class="won-section">
            <h2>Won Auctions</h2>
            <% if (wonAuctions.length > 0) { %>
              <ul>
                <% wonAuctions.forEach(function(item) { %>
                  <li>
                    <strong><%= item.title %></strong> - Won for ₹<%= item.maxamount %>
                  </li>
                <% }); %>
              </ul>
            <% } else { %>
              <p>You haven't won any auctions yet.</p>
            <% } %>            
          </div>
      </div>

      <script src="https://kit.fontawesome.com/10e51ef5e7.js" crossorigin="anonymous"></script>
  </body>
</html>
